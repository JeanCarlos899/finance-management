{% extends "financeapp/index.html" %}
{% load static %}
{% block title %}Gestor de Finanças - Início{% endblock title %}
{% block contentnav %}
<button class="btn btn-outline-info mr-3" data-toggle="modal" data-target="#modalFilters">
  <i class="fas fa-filter"></i>
</button>
<form action="{% url 'financeapp:dashboard' %}" method="GET">
    <div class="input-group input-group-sm">
      <div class="input-group-prepend">
        <span class="input-group-text">De</span>
      </div>
      <input type="date" class="form-control" aria-label="De" name="start_date" value="{{ start_date }}" required>
      <div class="input-group-prepend">
        <span class="input-group-text">Até</span>
      </div>
      <input type="date" class="form-control" aria-label="Até" name="end_date" value="{{ end_date }}" required>
      <div class="input-group-append">
        <button type="submit" class="btn btn-primary btn-block">Filtrar</button>
      </div>
    </div>
</form>
{% endblock contentnav %}
{% block content %}
<div class="row dashboard-content">
  <div class="col">

    <div class="row d-flex mt-3">
      <div class="col info-box bg-white mr-2">
        <span class="info-box-icon bg-warning"><i class="fas fa-landmark text-white-1" style="color: white;"></i></span>
        <div class="info-box-content">
          <span class="info-box-text">Saldo</span>
          <span class="info-box-number">R$ {{balance}}</span>
        </div>
      </div>
      <div class="col info-box bg-white mr-2">
        <span class="info-box-icon bg-success"><i class="fas fa-dollar-sign"></i></i></span>
        <div class="info-box-content">
          <span class="info-box-text">Receita</span>
          <span class="info-box-number">R$ {{sum_earnings}}</span>
        </div>
      </div>
      <div class="col info-box bg-white">
        <span class="info-box-icon bg-danger"><i class="fas fa-hand-holding-usd"></i></span>
        <div class="info-box-content">
          <span class="info-box-text">Despesas</span>
          <span class="info-box-number">R$ {{sum_expenses}}</span>
        </div>
      </div>
    </div>
    <div class="row d-flex">
      <div class="col info-box bg-white mr-2" style="height: 30vh;">
        <canvas id="barChartCol1"></canvas>
      </div>
      <div class="col info-box bg-white" style="height: 30vh;">
        <canvas id="myChart"></canvas>
      </div>
    </div>
    <div class="row d-flex">
      <div class="col info-box bg-white mr-2 flex-grow-1" style="height: 40vh;">

      </div>
      <div class="col-2 info-box bg-white mr-2" style="height: 40vh;">
        <canvas id="doughnutChartEarnings" class="chart"></canvas>
      </div>
      <div class="col-2 info-box bg-white mr-2" style="height: 40vh;">
        <canvas id="doughnutChartExpenses" class="chart"></canvas>
      </div>
      <div class="col-3 info-box bg-white" style="height: 40vh;">
        <canvas id="radarChart" class="chart"></canvas>
      </div>
    </div>
  </div>
</div>
{% endblock content %}
{% block scripts %}
<script>
  // Gráfico de barras e linhas 
  const labels = JSON.parse('{{ labels|escapejs }}');
  // Gráfico de barras e linha
  const earningsList = JSON.parse('{{ earnings_list|escapejs }}');
  const expensesList = JSON.parse('{{ expenses_list|escapejs }}')
  // Gráfico de pizza
  const categoryEarnings = JSON.parse('{{ category_earnings|escapejs }}');
  const categoryExpenses = JSON.parse('{{ category_expenses|escapejs }}');
  const dataEarningsCategory = JSON.parse('{{ data_earnings_category|escapejs }}');
  const dataExpensesCategory = JSON.parse('{{ data_expenses_category|escapejs }}');
</script>
<script src="{% static 'js/dashboard.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock scripts %}

{% block modal %}
  {% include 'financeapp/includes/modal-filters.html' %}
{% endblock modal %}